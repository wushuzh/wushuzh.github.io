<!DOCTYPE html>
<html lang="zh-cn">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>ARTS 2019w24</title>
<meta name="description" content="个人技术站点">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" href="https://wushuzh.github.io/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="https://wushuzh.github.io/css/font-awesome.min.css">
<link rel="stylesheet" href="https://wushuzh.github.io/css/owl.carousel.css">
<link rel="stylesheet" href="https://wushuzh.github.io/css/owl.theme.css">


  <link href="https://wushuzh.github.io/css/style.sea.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="https://wushuzh.github.io/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="https://wushuzh.github.io/img/favicon.png">


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-102509506-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              
              
<div class="col-xs-12 col-sm-12 col-md-12 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="https://wushuzh.github.io/">小强会武术</a></h1>
</div>

  <div class="row">
    <div class="col-lg-10 col-lg-offset-1">
      <div class="content-column-content">
      
      <div class="row">
        <div class="col-sm-4">
          
            <div class="image">
              <img src="https://wushuzh.github.io//img/blog/arts-51-per-week/user-data.gif" class="img-responsive" alt="">
            </div>
          
        </div>
        <div class="col-md-6">
            <h2>ARTS 2019w24</h2>
                <p>
                  <i class="fa fa-share-square-o fa-fw"></i><a href="/"> 小强会武术</a>
                </p>

                <p>
                <time datetime="2019-06-10 13:50:54 &#43;0800 CST">
                <i class="fa fa-calendar-o fa-fw"></i> 2019-06-10
                </time>
                &middot;
                1374 字
                &middot;
                3 分钟
                </p>

                
                <p>
                  <i class="fa fa-tags fa-fw" aria-hidden="true"></i>
                  <a href="/tags/arts">ARTS</a> &nbsp;&nbsp; <a href="/tags/union-find">Union-Find</a>
                </p>
                

        </div>
      </div>
      <br />

         <p>提高学习效率，少做无用功的一些技巧</p>

<h2 id="algorithm">Algorithm</h2>

<p><a href="https://leetcode.com/problems/accounts-merge/">leetcode #721 Accounts Merge</a> 以 email 作为依据合并冗余账户——此题的关键要梳理好三个概念：</p>

<ol>
<li>用户名：用户自行定义，现实世界中不同的人都会有重名现象，更何况同一用户会有小号——当下多数应用都不允许重名，但这样的要求多是从使用者角度的考量——要辅助用户互动中易于相互识别。但本题对“小号现象”理想化了一下：要求只要是同一用户，用户名一定一样；</li>
<li>邮箱地址：同一用户可以有多个邮箱使用在不同场景（工作邮箱，个人邮箱，国内备用邮箱……）；</li>
<li>账户: 如果同一用户通过不同邮箱注册，应用系统默它们是不同的账户，但如果账户存在辅助信息（比如备用邮箱），我们就可以将上面的同名账户关联起来——方便更合理的资源分配、信息整合等，最后返回的结果，用户名依然可能重复，但所有邮箱都只能出现一次——属于某一个用户；</li>
</ol>

<p>Union-Find 的实现要点：</p>

<ul>
<li>引入一个 dict，利用 email 的唯一性作为 key，value 为用户名，形成最终结果时查找会比较方便；</li>
<li>email 是 Union-Find 数据结构的核心，先将已知在同一账户下 email 做 union 操作，然后在整合其他用户邮箱时，因为之前的邮箱关联，会形成最终的“独立”用户邮箱组；</li>
<li>找出这些“独立”组利用 find_root 操作：只要 root 相同就在同一组，这个 root 因为有唯一性，可作为 dict 的 key；</li>
<li>python 的 collections 包中的 defaultdict 类特别适合作为获取独立用户的中转数据类型，最后配合 python 的 list comprehensions 和最开始引入的 email2name 字典返回题目要求结果；</li>
</ul>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">accounts_merge_using_union_find</span>(accounts: List[List[str]]) <span style="color:#f92672">-&gt;</span> List[List[str]]:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span>    uf <span style="color:#f92672">=</span> UnionFind()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span>    email_to_name <span style="color:#f92672">=</span> dict()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span>    <span style="color:#66d9ef">for</span> account <span style="color:#f92672">in</span> accounts:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span>        name <span style="color:#f92672">=</span> account[<span style="color:#ae81ff">0</span>]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span>        <span style="color:#66d9ef">for</span> email <span style="color:#f92672">in</span> account[<span style="color:#ae81ff">1</span>:]:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span>            email_to_name[email] <span style="color:#f92672">=</span> name
<span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span>            uf<span style="color:#f92672">.</span>union(email, account[<span style="color:#ae81ff">1</span>])
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span>    <span style="color:#66d9ef">return</span> [[email_to_name[pmail]] <span style="color:#f92672">+</span> sorted(emails) <span style="color:#66d9ef">for</span> (pmail, emails) <span style="color:#f92672">in</span> uf<span style="color:#f92672">.</span>groups()<span style="color:#f92672">.</span>items()]
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span style="color:#f92672">import</span> collections
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnionFind</span>:
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span>    <span style="color:#66d9ef">def</span> __init__(self):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span>        self<span style="color:#f92672">.</span>parent <span style="color:#f92672">=</span> dict()
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span>    <span style="color:#75715e"># omit method find_root and union</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">groups</span>(self):
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span>        merge_accounts <span style="color:#f92672">=</span> collections<span style="color:#f92672">.</span>defaultdict(list)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span>        <span style="color:#66d9ef">for</span> email <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>parent<span style="color:#f92672">.</span>keys():
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span>            merge_accounts[self<span style="color:#f92672">.</span>find_root(email)]<span style="color:#f92672">.</span>append(email)
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span>        <span style="color:#66d9ef">return</span> merge_accounts</code></pre></div>

<h2 id="review">Review</h2>

<p>如何搭建一个简单的 kubernetes 实验集群 ？</p>

<ul>
<li>纯手动利用 VirtualBox 在笔记本搭建；</li>
<li>半手工利用 ansible 优化 k8s 安装过程；</li>
<li>全自动利用 terraform 优化 OS 并集成整体安装过程；</li>
</ul>

<p><img alt="Kubernetes trial" src="/img/blog/arts-51-per-week/k8s-install.jpg" class="img-responsive"></p>

<h2 id="tip">Tip</h2>

<p>从 Medium 上看到 Marko Lukša 的一个 bash 技巧介绍：<a href="https://medium.com/@marko.luksa/bash-trick-repeat-last-command-until-success-750a61c43c8a">Bash trick: Repeat last command until success</a></p>

<p>有时 pod 启动有一个过程，此时执行查看各种查看，连接等操作都会失败。可以将下面的函数放入 .bashrc 中，自动帮我们重复上一条命令，直到被访问对象或服务变为可用状态，将我们计划执行的命令执行成功。原理就是利用 <a href="https://www.systutorials.com/docs/linux/man/1p-fc/">fc (process the command history list)</a> 获取上次运行的指令，然后放入循环：只要命令执行不成功，返回值不为 0，休眠一下，稍后再试。</p>

<p>应用场景可能有：</p>

<p>查看：</p>

<ul>
<li><code>kubectl get cm foo -o yaml</code></li>
<li><code>tailf /var/log/some.log</code></li>
</ul>

<p>等待服务：</p>

<ul>
<li><code>curl http://barsvc.default.svc.cluster.local:svcport</code></li>
<li><code>kubectl exec -it mypod bash</code></li>
<li><code>ssh me@host-restarting</code></li>
</ul>

<p>上面指令失败，无妨，执行 <code>rtp</code> 继续帮你执行，直到成功。</p>

<p><br/></p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span>rpt <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span>  CMD<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>fc -ln | tail -2 | head -1<span style="color:#66d9ef">)</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span>  echo <span style="color:#e6db74">&#34;repeating until success: </span>$CMD<span style="color:#e6db74">&#34;</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span>  <span style="color:#66d9ef">until</span> $CMD
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span>  <span style="color:#66d9ef">do</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span>    sleep <span style="color:#ae81ff">1</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span>  <span style="color:#66d9ef">done</span>
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span style="color:#f92672">}</span></code></pre></div>

<h2 id="share">Share</h2>

<p>看了一个youtube的推荐视频 <a href="https://youtu.be/IlU-zDU6aQ0">how to study smart by Marty Lobdell</a> Marty Lobdell 教授为新生普及如何高效学习：误区和技巧。其主业是心理学，课讲的风趣，正好我自己最近也在集中学习，要有意识地将下面记录的要点进行实践。</p>

<ul>
<li>心态上，要关注效率，保持积极心态，发现自己走神后，主动休息——像锻炼肌肉一样，逐渐增强学习长度，尝试每天完结后给予自己奖励；<br /></li>
<li>行动上，为自己营造一个学习角：专属台灯，正姿而专注，走神就关灯起身，主动休息；<br /></li>
<li>方法上，重概念，轻事实。将概念连接到已知的知识树上，能用自己的语言解释才算入门，对事实性知识，用各种各样的记忆术: 缩略、谐音、谚语、做诡异的可视花；</li>
<li>读书时，花5分钟审视全章(survey)内容，提出一些问题(question)，然后阅读(read)，背诵(recite)，回顾(review): SQ3R；</li>
<li>下课后，立刻花 5 分钟复习内容，参与小组讨论，不具备条件的对着空椅子讲述，好好休息</li>
</ul>

<p>封面图片来自 <a href="https://dribbble.com/shots/3211423-User-Data-Animated-Illustration">User Data Animated Illustration</a> <a href="https://dribbble.com/Ramotion"><i class="fa fa-dribbble" aria-hidden="true"></i> Ramotion</a></p>
         <div id="disqus_thread">
  <a href="#" onclick="disqus();return false;"> 点击启用 Disqus 评论文章 <i class="fa fa-comments" aria-hidden="true"></i></a>
</div>

<script type="text/javascript">
var disqus_loaded = false;
function disqus() {
  if (!disqus_loaded) {
    
    
    
    

    disqus_loaded = true;
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'wushuzh';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }
};
</script>

<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

      </div>
    </div>
  </div>
</div>
<noscript>
  <style>.jsonly { display: none }</style>
</noscript>

          </div>
      </div>
  </div>
  <script src="https://wushuzh.github.io/js/jquery.min.js"></script>
<script src="https://wushuzh.github.io/js/bootstrap.min.js"></script>
<script src="https://wushuzh.github.io/js/jquery.cookie.js"> </script>
<script src="https://wushuzh.github.io/js/ekko-lightbox.js"></script>
<script src="https://wushuzh.github.io/js/jquery.scrollTo.min.js"></script>
<script src="https://wushuzh.github.io/js/masonry.pkgd.min.js"></script>
<script src="https://wushuzh.github.io/js/imagesloaded.pkgd.min.js"></script>
<script src="https://wushuzh.github.io/js/owl.carousel.min.js"></script>
<script src="https://wushuzh.github.io/js/front.js"></script>

<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

</body>
</html>
